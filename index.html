<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex, nofollow">
    <title>Check-in Instructions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
body { margin:0; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; }
#map { height: 100vh; width: 100vw; }
#content { display:none; padding:16px; }
/* --- Dropdown Bar --- */
/* --- Image Modal --- */

#imgModal { z-index: 2147483647; }

#imgModal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  z-index: 2147483647;

  /* hidden by default */
  display: none;

  /* FLEX CENTERING */
  display: none;
  align-items: center;
  justify-content: center;

  /* block everything underneath */
  pointer-events: all;
}

#imgModal img {
  position: relative;      /* üî• override leaflet popup inheritance */
  display: block;          /* üî• required for centering */
  max-width: 90vw;
  max-height: 85vh;
  margin: auto;            /* üî• final centering guarantee */
  object-fit: contain;
  border-radius: 10px;
}
#imgModal .closeModal {
  position: absolute;
  top: 20px;
  right: 30px;
  color: #fff;
  font-size: 30px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
}

#imgModal .closeModal:hover {
  color: #bbb;
}

.topic-dropdown {
  position: sticky;
  top: 0;
  background: #f9f9f9;
  padding: 10px 16px;
  z-index: 2000;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  display: flex;
  justify-content: center;
}

.topic-dropdown select {
  padding: 8px 12px;
  font-size: 15px;
  border-radius: 8px;
  border: 1px solid #ccc;
  outline: none;
  cursor: pointer;
  background: #ffffff;
  transition: all 0.2s;
}
.app-header {
  position: sticky;
  top: 0;
  z-index: 3000;
  background: white;
  padding: 10px 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.logo {
  height: 32px;
  max-width: 160px;
  object-fit: contain;
}

.topic-dropdown select:hover {
  border-color: #2563eb;
}

.topic-dropdown select:focus {
  border-color: #2563eb;
  box-shadow: 0 0 5px rgba(37,99,235,0.5);
}

.step-content {
  display: flex;
  flex-direction: column;   /* stack text above image */
  align-items: center;      /* center horizontally */
}

.step-content img {
  max-width: 100%;          /* responsive width */
  width: 400px;             /* default width */
  border-radius: 8px;
  margin-top: 16px;
}
.app-bar {
  position: sticky;
  top: 56px; /* logo height */
  z-index: 2500;
  background: white;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
}

.app-tabs {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  scrollbar-width: none;
}

.app-tabs::-webkit-scrollbar {
  display: none;
}

.app-tabs button {
  flex-shrink: 0;
  padding: 8px 14px;
  border-radius: 999px;
  border: none;
  background: #f1f5f9;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  white-space: nowrap;
}

.app-tabs button.active {
  background: #2563eb;
  color: white;
}

/* --- Step Bar --- */

.instruction-bar {
  position: sticky;
  top: 110px; /* header + dropdown */
  margin: 12px auto;
  width: calc(100% - 24px);
  max-width: 520px;
  background: white;
  z-index: 1000;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.18);
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 14px;
}
.popup-scroll { max-height:380px; overflow-y:auto; }
.icon-marker { background:none; border:none; }
.icon-wrapper { width:25px;height:25px;background:white;border:3px solid #020202;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 10px rgba(0,0,0,0.3);}
.icon-wrapper img{width:18px;height:18px;object-fit:contain;}
.nav-btn { background:#2563eb;color:white;border:none;border-radius:50%;width:36px;height:36px;font-size:18px;cursor:pointer;}
.nav-btn:disabled { background:#cbd5f5; }
.step-text { flex:1; font-size:14px;}
.step-text strong { display:block; font-size:15px;}
.topic-dropdown { position:sticky; top:0; background:white; padding:8px 16px; z-index:2000; box-shadow:0 2px 6px rgba(0,0,0,0.15);}
.topic-dropdown select { padding:6px 10px; font-size:14px; border-radius:6px; border:1px solid #ccc;}
</style>
  </head>
  <body>
    <div class="app-header">
      <img src="FourHaus.png" alt="Company Logo" class="logo">
    </div>
    <div id="imgModal">
      <span class="closeModal">&times;</span>
      <img id="modalImg" src=""/>
    </div>
    <!-- Topic Selector -->
    <div class="app-bar">
      <div class="app-tabs">
        <button onclick="goToTopic(0)" id="tab-0">Lockbox</button>
        <button onclick="goToTopic(3)" id="tab-3">Parking</button>
        <button onclick="goToTopic(1)" id="tab-1">Building Entry</button>
        <button onclick="goToTopic(2)" id="tab-2">Amenities</button>
      </div>
    </div>

    <!-- Step Navigation Bar -->
    <div class="instruction-bar">
      <button class="nav-btn" id="prevBtn" onclick="prevStep()">‚Äπ</button>
      <div class="step-text" id="stepText"></div>
      <button class="nav-btn" id="nextBtn" onclick="nextStep()">‚Ä∫</button>
    </div>

    <!-- Map for topics that need it -->
    <div id="map"></div>

    <!-- Content div for topics without map -->
    <div id="content"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>

// --- Initialize Map ---
const map = L.map('map',{ zoomControl:false }).setView([-33.8768, 151.2054], 17);
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {subdomains:'abcd', maxZoom:20}).addTo(map);
L.control.zoom({ position: 'bottomright' }).addTo(map);

// --- Map Markers (Lockbox Topic) ---
const sunTower = L.marker([-33.87729669864325, 151.2058196775788]).bindPopup(`<strong>Sun Tower Entrance</strong><br><img src="Sun Tower.png" style="width:300px;border-radius:8px;margin-top:8px;">`).addTo(map);
const lockboxIcon = L.divIcon({className:'icon-marker',html:`<div class="icon-wrapper"><img src="lockbox.png"></div>`, iconAnchor:[10,17]});
const lockbox = L.marker([-33.87703364976371,151.20497041045243],{icon:lockboxIcon}).bindPopup(`<div class="popup-scroll"><strong>Lockbox ‚Äì Located on Eagar Street</strong><br><img src="eagar.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`,{maxHeight:300,minWidth:330}).addTo(map);
const apartmentIcon = L.divIcon({className:'icon-marker',html:`<div class="icon-wrapper"><img src="apartment.png"></div>`,iconAnchor:[10,17]});
const property = L.marker([-33.87682707734486,151.2060015701829],{icon:apartmentIcon}).bindPopup(`<strong>Four Haus Residence</strong><br><img src="apartmentImage.JPG" style="width:300px;border-radius:8px;margin-top:8px;">`).addTo(map);
const corridorPopup = L.popup({ maxHeight: 300, minWidth:330 }).setContent(`<div class="popup-scroll"><strong>Mall Corridor</strong><br>Walk through the mall corridor<br><img src="corridor.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`);

// Routes
const route0 = L.polyline([[-33.87729669864325,151.2058196775788],[-33.87717127441062,151.205361210565]],{color:'#0ea5e9',weight:5});
const route1 = L.polyline([[-33.87729669864325,151.2058196775788],[-33.87703364976371,151.20497041045243]],{color:'#2563eb',weight:5});
const route2 = L.polyline([[-33.87703364976371,151.20497041045243],[-33.87729669864325,151.2058196775788]],{color:'#9333ea',weight:5});
const route3 = L.polyline([[-33.87729669864325,151.2058196775788],[-33.87682707734486,151.2060015701829]],{color:'#16a34a',weight:5});
const lockboxLayers = [
  sunTower,
  lockbox,
  property,
  route0,
  route1,
  route2,
  route3
];

function showLockboxLayers() {
  lockboxLayers.forEach(layer => {
    if (!map.hasLayer(layer)) {
      layer.addTo(map);
    }
  });
}

function hideLockboxLayers() {
  lockboxLayers.forEach(layer => {
    if (map.hasLayer(layer)) {
      map.removeLayer(layer);
    }
  });
}
//Parking markers
const parkingIcon = L.divIcon({
  className: 'icon-marker',
  html: `
    <div class="icon-wrapper">
      <img src="parkingIcon.png">
    </div>
  `,
  iconAnchor: [10, 17]
});


const lockboxParking = L.marker([-33.87703364976371,151.20497041045243],{icon:lockboxIcon}).bindPopup(`<div class="popup-scroll"><strong>Lockbox ‚Äì Located on Eagar Street</strong><br><img src="eagar.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`,{maxHeight:300,minWidth:330}).addTo(map);
const parkingMarker = L.marker(
  [-33.87676394971108, 151.2051343753472],
  { icon: parkingIcon }
).bindPopup(`
  <div class="popup-scroll">
    <strong>Parking Entrance</strong><br>
    <p>Enter via George Street parking ramp.</p>
    <img src="parkingEntrance.jpg"
         style="width:300px;border-radius:8px;margin-top:8px;">
  </div>
`);

const liverpoolSt = L.marker(
  [-33.87621216888041, 151.20499227269897],
).bindPopup(`
  <div class="popup-scroll">
    <strong>Turn left on Liverpool St onto Douglass Street</strong><br>
    <img src="liverpoolSt.png"
         style="width:300px;border-radius:8px;margin-top:8px;">
  </div>
`);

const douglassStEntrance = L.marker(
  [-33.87679156194186, 151.20500212127874
],
).bindPopup(`
  <div class="popup-scroll">
    <strong>Head to Eagar Street to collect your keys</strong><br>
    <img src="douglasSt.png"
         style="width:300px;border-radius:8px;margin-top:8px;">
  </div>
`);

const parkingRoute = L.polyline([
  [-33.87621216888041, 151.20499227269897], // parking entrance
  [-33.87621942917767, 151.20487203199662],
  [-33.87672764845027, 151.20481737713195],
  [-33.87676394971108, 151.2051343753472]    // destination
], { color: '#f59e0b', weight: 5 });

const parkingToEagar = L.polyline([
  [-33.876754874401485, 151.20502943800545], // parking entrance
  [-33.87703364976371,151.20497041045243]    // destination
], { color: '#f59e0b', weight: 5 });


// --- Parking Layers Array ---
const parkingLayers = [
  parkingMarker,lockboxParking,
  parkingRoute,parkingToEagar,
  douglassStEntrance, 
  liverpoolSt
];

function showParkingLayers() {
  parkingLayers.forEach(layer => {
    if (!map.hasLayer(layer)) layer.addTo(map);
  });
}

function hideParkingLayers() {
  parkingLayers.forEach(layer => {
    if (map.hasLayer(layer)) map.removeLayer(layer);
  });
}
let activeRoute = null;
function updateRoute(route){ if(activeRoute && map.hasLayer(activeRoute)){ map.removeLayer(activeRoute); } activeRoute = route; activeRoute.addTo(map); }
function openPopupLower(marker, zoom=18, offsetY=0){ const point=map.latLngToContainerPoint(marker.getLatLng()); const newPoint=L.point(point.x,point.y-offsetY); map.flyTo(map.containerPointToLatLng(newPoint), zoom); marker.openPopup(); }

// --- Steps for All Topics ---
const allSteps = [
  // --- Topic 0: Lockbox Instructions (Map-based) ---
  [
  {
    title: "Step 1 ‚Äì Approach Sun Tower at 591 George Street",
    text: "Enter the mall, walk past Sun Coffee, and continue straight towards the back.",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      showLockboxLayers();
      hideParkingLayers();
      updateRoute(route0);
      openPopupLower(sunTower);
      sunTower.getPopup().setContent(`<strong>Sun Tower Entrance</strong><br><img src="Sun Tower.png" style="width:300px;border-radius:8px;margin-top:8px;">`)
    }
  },
  {
    title: "Step 2 ‚Äì Walk through mall corridor",
    text: "Keep walking straight through the mall corridor until you reach a glass door labelled ‚ÄúPublic Access to Eagar Street.‚Äù",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      updateRoute(route0);
      corridorPopup
        .setLatLng([-33.87717127441062,151.205361210565])
        .setContent(`<div class="popup-scroll"><strong>Mall Corridor</strong><br>Walk through the mall corridor<br><img src="corridor.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
        .openOn(map);
            openPopupLower(corridorPopup);

    }
  },
  {
    title: "Step 3 ‚Äì Walk towards Eagar St",
    text: "1) Exit the mall and walk towards Eagar Street, then turn right. <br>2) The lockbox is located on the first window grille on Eagar Street. <br> 3) Look for the lockbox labelled '4H'.",
    action: () => {
      lockbox.getPopup().setContent(`<div class="popup-scroll"><strong>Lockbox ‚Äì Located on Eagar Street</strong><br><img src="eagar.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`);
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      updateRoute(route1);
      openPopupLower(lockbox);
    }
  },
  {
    title: "Step 4 ‚Äì Collect the keys keycards and remote",
    text: "1) Retrieve the keys from the lockbox labelled '4H' using the code provided. <br> 2) You should see 2 sets of keys and keycards. <br> 3) After closing the lockbox, scramble the numbers.",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      updateRoute(route2);
      lockbox.getPopup().setContent(`<div class="popup-scroll"><strong>Lockbox <img src="lockboxLocation.JPG" style="width:300px;border-radius:8px;margin-top:8px;"></div>`);
      openPopupLower(lockbox)

      }
  },
  {
    title: "Step 5 ‚Äì Return to George Street",
    text: "Walk back the same way you came from.",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      updateRoute(route2);
      sunTower.getPopup()
        .setContent(`<div class="popup-scroll"><strong>Return to George Street</strong><br><img src="BackToGeorge.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
        .openOn(map);
      openPopupLower(sunTower)
    }
  },
  {
    title: "Step 6 ‚Äì Welcome to your home away from home",
    text: "After exiting Sun Tower, turn left and walk towards 569 George St, just a few shops away. <br> <a href='#' onclick='goToTopic(1)'> <br> Click here for Apartment entry instructions </a>",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";
      updateRoute(route3);
      openPopupLower(property);
    }
  }
]
,
  // --- Topic 1: Building & Apartment Entry ---
  [
    {
        title: "Step 1 ‚Äì Building Entry",
        text: "Scan the key card against the reader until you hear a beep. The glass door should open.",
        action: () => {
            document.getElementById("map").style.display = "none";
            document.getElementById("content").style.display = "block";
            document.getElementById("content").innerHTML = `
            <div class="step-content">
                <img src='cardReader.JPG'>
            </div>
            `;
        }
    },
  {title:"Step 2 ‚Äì Walk towards the Lift lobby", text:"Proceed to lift lobby. <br> You are on <b>LEVEL 25</b>, only use the lifts on the left with <b> High Rise Access </b> ", action:()=>{ document.getElementById("map").style.display="none"; document.getElementById("content").style.display="block"; document.getElementById("content").innerHTML = `
      <div class="step-content">
        <img src='lobby.gif'>
      </div>
    `; }},
    {
        title: "Step 3 ‚Äì Enter the lift",
        text: "Scan the key card on the reader and press level 25 ",
        action: () => {
            document.getElementById("map").style.display = "none";
            document.getElementById("content").style.display = "block";
            document.getElementById("content").innerHTML = `
            <div class="step-content">
                <img src='lift.JPG'>
            </div>
            `;
        }
    },
    {
        title: "Step 4 ‚Äì Turn right after exiting the lift ",
        text: "After exiting the lift, turn right into the corridor. <br> The apartment is located at the end of the corridor.",
        action: () => {
            document.getElementById("map").style.display = "none";
            document.getElementById("content").style.display = "block";
            document.getElementById("content").innerHTML = `
            <div class="step-content">
                <img src='level25.gif'>
            </div>
            `;
        }
    },
    {
        title: "Step 5: Welcome  ",
    text: `
      <strong>Door Opening Instructions:</strong><br>
      1. Insert the <b>GREEN</b> key into the top keyhole.<br>
      2. Turn the key clockwise and<br>
      3. Pull down the door handle at the same time while pushing the door open.
    `,        action: () => {
            document.getElementById("map").style.display = "none";
            document.getElementById("content").style.display = "block";
            document.getElementById("content").innerHTML = `
            <div class="step-content">
                <img src='door.JPG'>
            </div>
            `;
        }
    }
  ],

  // --- Topic 2: Amenities Guide ---
  [
  {
    title: "Step 1 ‚Äì Amenities are located at level P1",
    text: "Amenties like the swimming pool, gym and sauna are located on Level P1 of the buiding.<br> Take the lift down to Level 'P1' <br> <b> Please remember to take your access card along with you </b>",
    action: () => {
      document.getElementById("map").style.display = "none";
      document.getElementById("content").style.display = "block";
    }
  },
    ],


  // --- Topic 3: Return / Exiting ---
  [
  {
    title: "Step 1 ‚Äì Parking is located on 1 Douglass St",
    text: "On Liverpool Street, turn left onto Douglass Street. <br> Please note this is a small alleyway and can be easily missed. Please also take extra care for oncoming vehicles and pedestrians.",
    action: () => {
      document.getElementById("map").style.display = "block";
      document.getElementById("content").style.display = "none";

      // Remove all markers & routes
      hideLockboxLayers();
      showParkingLayers();
      openPopupLower(liverpoolSt)

      // Optional: reset map view for parking
      map.flyTo([-33.87621216888041, 151.20499227269897],18);
    }
    
  },
  {
    title: "Step 2: Collect the keys from Eagar St",
    text: "1) Eagar Street is on the right of Douglass St. <br> 2) Turn into Eagar Street and stop your car in a safe spot. ",
    action: () => {
      douglassStEntrance.getPopup().setContent(`<div class="popup-scroll"><strong>Lockbox <img src="douglasSt.png" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
      map.flyTo([-33.87703364976371,151.20497041045243], 18);
      openPopupLower(douglassStEntrance)

    }},
    
    {
    title: "Step 3: Pick up the keys from Eagar Street",
    text: "1) Head to the first window on Eagar Street and locate the lockbox marked '4H'.‚Äù <br>2) Unlock the lockbox to access the keys, keycards, and remote with the lockcode provided <br>3) Lock the lockbox again by scrambling the numbers.",
    action: () => {
      lockboxParking.getPopup().setContent(`<div class="popup-scroll"><strong>Lockbox <img src="eagar4.JPG" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
      map.flyTo([-33.87703364976371,151.20497041045243], 18);
          openPopupLower(lockboxParking)

    }
},
{
    title: "Step 4: Unlock the garage door",
    text: "Unlock the garage door by pressing 1 on the remote.",
    action: () => {
      parkingMarker.getPopup().setContent(`<div class="popup-scroll">Unlock the garage gate with the remote<img src="remote.jpg" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
      map.flyTo([-33.87703364976371,151.20497041045243], 18);
          openPopupLower(parkingMarker)

    }}
    ,
    {
    title: "Step 5: Enter the garage and turn left",
    text: "1) Car space is located on <b>LEVEL 2</b>. <br> 2) Turn left after entering the gate and turn right UP the ramp <br> 3) Keep going up until you see level 2 <br> 4) The car space is on the left on Level 2, before the ramp goes up again. ",
    action: () => {
      parkingMarker.getPopup().setContent(`<div class="popup-scroll"> <img src="garageInstruction.gif" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
      map.flyTo([-33.87703364976371,151.20497041045243], 18);
          openPopupLower(parkingMarker)

    }},
    {
    title: "Step 6: Park in desginated car spot You are on LEVEL 2",
    text: "Please park in the car space marked 325. This space can accommodate two cars; however, please use only one bay. <br>The lifts are located beside the car spaces. Please take only the lifts that go to Level 25.",
    action: () => {
      parkingMarker.getPopup().setContent(`<div class="popup-scroll"> <img src="carspot.JPG" style="width:300px;border-radius:8px;margin-top:8px;"></div>`)
      map.flyTo([-33.87703364976371,151.20497041045243], 18);
          openPopupLower(parkingMarker)

    }}
]
];

// Current topic and step
let currentTopic = 0;
let currentStep = 0;

function updateActiveTab() {
  document.querySelectorAll(".app-tabs button").forEach(btn => {
    btn.classList.remove("active");
  });
  const active = document.getElementById(`tab-${currentTopic}`);
  if (active) active.classList.add("active");
}
function renderStep(){ 
  allSteps[currentTopic][currentStep].action();
  document.getElementById("stepText").innerHTML =
    `<strong>${allSteps[currentTopic][currentStep].title}</strong><br>${allSteps[currentTopic][currentStep].text}`;
  prevBtn.disabled = currentStep === 0;
  nextBtn.disabled = currentStep === allSteps[currentTopic].length - 1;
  updateActiveTab();
}

function nextStep(){ if(currentStep<allSteps[currentTopic].length-1){ currentStep++; renderStep(); }}
function prevStep(){ if(currentStep>0){ currentStep--; renderStep(); }}
function jumpToTopic(){ 
  currentTopic=parseInt(document.getElementById("topicSelect").value); 
  currentStep=0; 
  renderStep();
}
function goToTopic(topicIndex) {
  currentTopic = topicIndex;
  currentStep = 0;
  renderStep();
}

renderStep();
// --- Image Modal Logic ---
const modal = document.getElementById("imgModal");
const modalImg = document.getElementById("modalImg");
const closeModal = document.querySelector("#imgModal .closeModal");

// Close modal on clicking X or outside the image
closeModal.onclick = () => { modal.style.display = "none"; };
modal.onclick = (e) => { if(e.target === modal) modal.style.display = "none"; };

document.addEventListener("click", function (e) {
  const img = e.target.closest(".step-content img, .leaflet-popup-content img");
  if (!img) return;

  modal.style.display = "flex";   // üî• FLEX, not block
  modalImg.src = img.src;

  document.body.style.overflow = "hidden";
});

</script>

  </body>
</html>
